<div class="all-cards-page">
  <div class="top-bar">
    <div class="select-container">
      <select class="workspace-select" [(ngModel)]="selectedWorkspace">
        @for (workspace of workspaces; track workspace.displayName) {
          <option [value]="workspace.displayName">
            {{ workspace.displayName }}
          </option>
        }
      </select>
    </div>
    <button class="new-tickets-btn" (click)="openCreateModal()">
      New ticket
    </button>
  </div>

  <h2 class="tickets-title">Tickets {{ tickets.length }}</h2>

  <table class="tickets-table">
    <thead>
      <tr>
        <th>Resume</th>
        <th>ID</th>
        <th>Manager</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ticket of tickets">
        <td>
          <app-card
            [titre]="ticket.titre"
            [statusCard]="ticket.statusCard"
            [ticketId]="ticket.ticketId"
            [manager]="ticket.manager"
            (cardClick)="openModal(ticket)"
          ></app-card>
        </td>
        <td>{{ ticket.ticketId }}</td>
        <td>{{ ticket.manager }}</td>
      </tr>
    </tbody>
  </table>

  <app-modal-view
    *ngIf="selectedTicket && !isEditMode"
    [ticket]="selectedTicket"
    (close)="closeModal()"
    (edit)="switchToEdit()"
  ></app-modal-view>

  <app-modal-edit
    *ngIf="selectedTicket && isEditMode"
    [ticket]="selectedTicket"
    (close)="closeModal()"
    (valid)="onValidEdit()"
  ></app-modal-edit>

  <app-modal-create
    *ngIf="isCreateMode"
    (close)="closeCreateModal()"
    (create)="onCreateTicket($event)"
  ></app-modal-create>
</div>
